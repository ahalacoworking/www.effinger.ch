{{ define "main" }}
<!-- Page Wrap -->
<div class="page organisation" id="top">

  <nav class="main-nav dark transparent stick-fixed">
    {{ partial "navigation.html" . }}
  </nav>

  <!-- Header -->
  <section class="small-section-header bg-dark-lighter">
    <div class="relative container align-left pt-80">

      <div class="row">

        <div class="col-md-8">
          <h1 class="hs-line-11 font-alt mb-0">Member werden</h1>
          <!--
          <div class="hs-line-4 font-alt mt-20 mt-xs-0">
          Grundsätze
          </div>
          -->
        </div>

        <div class="col-md-4 mt-30">
          <div class="mod-breadcrumbs font-alt align-right">
            <a href="/community/"><i class="fa fa-angle-left"></i> Zurück zu Community</a>
          </div>
        </div>
      </div>

    </div>
  </section>
  <!-- End Header -->

  <!-- Section -->
  <section class="page-section bg-gray">
    <div class="container relative">

      <div class="row">

        <!-- Content -->
        <div class="col-sm-10 col-sm-offset-1">

          <!-- Text -->
          <div class="section-text">
            {{ .Content }}
            
          </div>
          <!-- End Text -->

        </div>
        <!-- End Content -->
      </div>

    </div>
  </section>
  <!-- End Section -->
  
  <!-- Section -->
  <section class="page-section">
    <div class="container relative">

      <div class="row">

        <!-- Content -->
        <div class="col-sm-10 col-sm-offset-1">

          <!-- Text -->
          <div class="section-text">
            <h1 class="mt-0 font-alt">{{ .Title }}</h1>

            <form name="Community Membership" action="thank-you" class="form" netlify>

              <div class="row">
                
                <div class="col-sm-6 mb-20 mb-md-10">
                  <label for="vorname">Vorname</label>
                  <input type="text" name="vorname" class="input-md form-control" placeholder="" maxlength="100" validate="notEmpty">
                </div>
                
                <div class="col-sm-6 mb-20 mb-md-10">
                  <label for="nachname">Nachname</label>
                  <input type="text" name="nachname" class="input-md form-control" placeholder="" maxlength="100" validate="notEmpty">
                </div>
              </div>
          
              <div class="row">
                <div class="col-sm-4 mb-20 mb-md-10">
                  <label for="geburtsdatum">Geburtsdatum</label>
                  <input type="text" name="geburtsdatum" class="input-md form-control" placeholder="tt.mm.jjjj" maxlength="10" validate="notEmpty">
                </div>
              </div>

              <div class="row">
                <div class="col-sm-6 mb-20 mb-md-10">
                  <label for="strasse">Strasse</label>
                  <input type="text" name="strasse" class="input-md form-control" placeholder="" maxlength="100" validate="notEmpty">
                </div>
                
                <div class="col-sm-2 mb-20 mb-md-10">
                  <label for="plz">PLZ</label>
                  <input type="text" name="plz" class="input-md form-control" placeholder="" maxlength="5"  validate="notEmpty">
                </div>
                
                <div class="col-sm-4 mb-20 mb-md-10">
                  <label for="ort">Ort</label>
                  <input type="text" name="ort" class="input-md form-control" placeholder="" maxlength="50"  validate="notEmpty">
                </div>
              </div>
              
              <div class="row">
                <div class="col-sm-6 mb-20 mb-md-10">
                  <label for="email">E-Mail-Adresse</label>
                  <input type="email" name="email" class="input-md form-control" placeholder="" maxlength="100" validate="email">
                </div>

                
                <div class="col-sm-6 mb-20 mb-md-10">
                  <label for="telefon">Telefon</label>
                  <input type="text" name="telefon" class="input-md form-control" placeholder="" maxlength="100" validate="notEmpty">
                </div>
              </div>

              <div class="mb-20 mb-md-10">
                <label for="bemerkungen">Bemerkungen</label>
                <textarea name="bemerkungen" class="input-md form-control" rows="3" placeholder="" maxlength="400"></textarea>
              </div>

              <button type="submit" class="btn btn-mod btn-large btn-round">Abschicken</button>

            </form>
            
          </div>
          <!-- End Text -->

        </div>
        <!-- End Content -->
      </div>

    </div>
  </section>
  <!-- End Section -->
</div>
<!-- End Page Wrap -->

<script>
// *******************************
// Handle the form.
// *******************************
$('form').on('click', 'button', function (e) {
  // Clear invalid markers.
  reset();

  var formData = {};

  // Get input field values and validate
  // We simply change border color to red if empty field using .css()
  var error = '';

  $(this).find(':input').each(function () {
    var validate = $(this).attr('validate');
    if (validate) {
      if (validate == 'notEmpty') {
        if (!$(this).val().trim()) {
          $(this).addClass('invalid');
          error += '<li>' + $(this).name + ' fehlt</li>';
        }
      } else if (validate == 'email') {
        if (!$(this).val().trim() || !isEmail($(this).val())) {
          $(this).addClass('invalid');
          error += '<li>Keine korrekte E-Mail-Adresse</li>';
        }
        }
      }
    }
    // TODO: Continue here. The following is not finished!
    
    // Submit when valid.
    if (!error) {
      // Reset fields, leave all contact info in the form.
      dialogElement.find('#res-title, #res-date, #res-comments').val('');
      dialogElement.find('#res-extras input').prop('checked', function() {
        return this.defaultChecked;
      });
      dialogElement.find('#res-start-time option, #res-end-time option').prop('selected', function() {
        return this.defaultSelected;
      });
      
      submitNewEvent(eventData);
      
      
      // Show the success message.
      dialogElement.find('#calendar-dialog-form-content').hide();
      dialogElement.find('#calendar-dialog-success-content').show();
      
      calendarElement.fullCalendar('unselect');
    } else {
      // Show validation error message.
      dialogElement.find('#validation-error-message .error-details').html(error);
      dialogElement.find('#validation-error-message').show();
    }
  });
});


function reset() {
  
  dialogElement.find('.invalid').removeClass('invalid');
  dialogElement.find('#validation-error-message').hide();
  dialogElement.find('#calendar-dialog-success-content').hide();
  dialogElement.find('#calendar-dialog-form-content').show();
}

function isEmail(email) {
  var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  return regex.test(email);
}

function submitNewEvent(eventData) {
  // Convert the date to ISO String.
  eventData.start = eventData.start.toISOString();
  eventData.end = eventData.end.toISOString();

  // POST-like request from GET via "_method" parameter,
  // to be cross-origin friendly.
  var xhr = $.ajax({
    method: "GET",
    url: calendarApiPath,
    data: {
      _method: "POST",
      calendarId: calendarId,
      event: JSON.stringify(eventData)
    },
    dataType: "jsonp",
    success: function(data) {
      // Refetch events to show that our event is now visible.
      calendarElement.fullCalendar('refetchEvents');

      // console.log(this.url);
      // console.log(JSON.stringify(data));
    }
  });
}
</script>


{{ end }}
