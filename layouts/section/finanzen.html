<!DOCTYPE html>
<html lang="de">
{{ partial "head.html" . }}

<body>

  <!-- Page Wrap -->
  <div class="page finanzen" id="top">

    <nav class="main-nav dark transparent stick-fixed">
      {{ partial "navigation.html" . }}
    </nav>

    <!-- Header -->
    <section class="small-section bg-dark-lighter">
      <div class="relative container align-left pt-80">

        <div class="row">

          <div class="col-md-8">
            <h1 class="hs-line-11 font-alt mb-20 mb-xs-0">Finanzen</h1>
            <!--
            <div class="hs-line-4 font-alt">
            Grundsätze
            </div>
            -->
          </div>

          <div class="col-md-4 mt-30">
            <div class="mod-breadcrumbs font-alt align-right">
              <a href="/ueber/">Community</a>&nbsp;/&nbsp;<span>Finanzen</span>
            </div>
          </div>
        </div>

      </div>
    </section>
    <!-- End Header -->

    <!-- Section -->
    <section class="page-section bg-gray-lighter">
      <div class="container relative align-center">
        <!--
        <h2 class="section-title font-alt mb-70 mb-sm-40">
          Werte
        </h2>
        -->

      <div class="row section-text">
        <div class="col-md-offset-2 col-md-8">
          <p>
            Wir versuchen, unsere Zahlen so weit wie möglich öffentlich zugänglich
            zu machen. Damit sollen sich alle Betroffenen und Interessierten ein
            Bild machen können, wie sich die Finanzen der Effinger Community
            entwickeln.
          </p>
          <p>
            Warum tun wir dies? Weil wir keinen Grund sehen, weshalb solche
            Zahlen geheim bleiben sollten. Und wir glauben, dass Transparenz
            ganz viele positive Effekte hat. Du kannst mehr über unsere Überzeugung
            lesen im <a href="/grundsaetze/transparenz/">Grundsatz der
            Transparenz</a>.
          </p>
        </div>
      </div>
    </section>
    <!-- End Section -->

    <!-- Section -->
    <section class="page-section">
      <div class="container relative">
        <!-- Text -->
        <div class="long-text-body">
          <h1 class="mt-0 font-alt">Finanzen 2016</h1>

          <div class="mb-40">
            <div id="year-chart-legend" class="chart-legend"></div>
            <canvas id="year-chart"></canvas>
          </div>

          <div class="row">
          {{ range $i, $e := sort .Data.Pages "Date" "asc" }}
            <div class="col-md-4 col-sm-6 monats-box">
              <div class="inner mt-20 mb-20 clearfix">
                <h4 class="title">{{ partial "format/month_de.html" .Date.Month }}</h4>
                <div class="wave-spacer"></div>
                {{ partial "finanzen/kennzahlen.html" $e }}
                <div class="item">
                  <p class="align-center">
                    <a href="{{ .RelPermalink }}" class="btn btn-mod btn-gray btn-round"><i class="fa fa-angle-right"></i> Details</a>
                  </p>
                </div>
              </div>


              {{/* Collecting the month names in German. */}}
              {{ partial "format/month_de.html" .Date.Month | chomp | $.Scratch.SetInMap "monate" (print $i) }}

              {{/* Putting the month and totals into the top level $ variable to make it available in the script below. */}}
              {{ .Scratch.Get "total_aufwand" | $.Scratch.SetInMap "aufwaende" (print $i) }}
              {{ .Scratch.Get "total_ertrag" | $.Scratch.SetInMap "ertraege" (print $i) }}

            </div>
          {{ end }}
          </div>
        </div>
        <!-- End Text -->
      </div>
    </section>
    <!-- End Section -->

    {{ partial "footer.html" . }}

  </div>
  <!-- End Page Wrap -->

  {{ partial "body_includes.html" . }}

  <script type="text/javascript" src="/js/Chart.min.js"></script>
  <script type="text/javascript">
  var ctx = document.getElementById("year-chart").getContext("2d");
  var data = {
      labels: {{ .Scratch.GetSortedMapValues "monate" }},
      datasets: [
          {
              label: "Ertrag",
              fillColor: "rgba(151,187,205,0.5)",
              strokeColor: "rgba(151,187,205,0.8)",
              highlightFill: "rgba(151,187,205,0.75)",
              highlightStroke: "rgba(151,187,205,1)",
              data: {{ .Scratch.GetSortedMapValues "ertraege" }}
          },
          {
              label: "Aufwand",
              fillColor: "rgba(220,220,220,0.5)",
              strokeColor: "rgba(220,220,220,0.8)",
              highlightFill: "rgba(220,220,220,0.75)",
              highlightStroke: "rgba(220,220,220,1)",
              data: {{ .Scratch.GetSortedMapValues "aufwaende" }}
          }
      ]
  };
  var myBarChart = new Chart(ctx).Bar(data, {
    //String - A legend template
    legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].fillColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%> in CHF</li><%}%></ul>",
    scaleLabel: function(label){return label.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, "'");},
    multiTooltipTemplate: function(label){return label.datasetLabel + ": CHF " + label.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, "'");},
    responsive: true
  });

    document.getElementById('year-chart-legend').innerHTML = myBarChart.generateLegend();
  </script>

</body>
</html>
